x = "Valor",
y = "Frecuencia")
#a)
df%>%
ggplot(aes(x=gamma))+
geom_histogram(fill="skyblue",color="black")+
geom_vline(xintercept = media,color="red")+
labs(title="Histograma de una muestra con tamaño 10000",
x = "Valor",
y = "Frecuencia")
#a)
df%>%
ggplot(aes(x=gamma))+
geom_histogram(fill="skyblue",color="black")+
geom_vline(xintercept = media,color="red",size=1.5)+
labs(title="Histograma de una muestra con tamaño 10000",
x = "Valor",
y = "Frecuencia")
#a)
df%>%
ggplot(aes(x=gamma))+
geom_histogram(fill="skyblue",color="black")+
geom_vline(xintercept = media,color="red",size=1.2)+
labs(title="Histograma de una muestra con tamaño 10000",
x = "Valor",
y = "Frecuencia")
#a)
df%>%
ggplot(aes(x=gamma))+
geom_histogram(fill="skyblue",color="black")+
geom_vline(xintercept = media,color="red",size=1.0)+
labs(title="Histograma de una muestra con tamaño 10000",
x = "Valor",
y = "Frecuencia")
#a)
df%>%
ggplot(aes(x=gamma))+
geom_histogram(fill="skyblue",color="black")+
geom_vline(xintercept = media,color="red",size=0.8)+
labs(title="Histograma de una muestra con tamaño 10000",
x = "Valor",
y = "Frecuencia")
#a)
df%>%
ggplot(aes(x=gamma))+
geom_histogram(fill="skyblue",color="black")+
geom_vline(aes(xintercept = media,color="Media"),size=0.8)+
scale_color_manual(name = "Referencia",values = c("Media"="red"))+
labs(title="Histograma de una muestra con tamaño 10000",
x = "Valor",
y = "Frecuencia")
#c)
skewness(df$gamma)
#c)
asimetria<-skewness(df$gamma)
#c)
asimetria<-skewness(gamma)
#d)
a<-rgamma(n=10000,shape=1,scale=1)
b<-rgamma(n=10000,shape=3,scale=5)
df<-tibble(a,b)%>%pivot_longer(cols=c(a,b),
names_to="Distribucion",
values_to="Valores")
#d)
a<-rgamma(n=10000,shape=1,scale=1)
b<-rgamma(n=10000,shape=3,scale=5)
df<-tibble(a,b)%>%pivot_longer(cols=c(a,b),
names_to="Distribucion",
values_to="Valores")
View(df)
df%>%
ggplot(aes(x = Valores, fill = Distribucion)) +
geom_histogram(alpha = 0.5, position = "identity", bins = 50) +
labs(title = "Comparación de distribuciones Gamma",
x = "Valor",
y = "Frecuencia") +
theme_minimal()
df%>%
ggplot(aes(x = Valores, fill = Distribucion)) +
geom_histogram(alpha = 0.5, position = "identity", bins = 50) +
labs(title = "Comparación de distribuciones Gamma",
x = "Valor",
y = "Frecuencia") +
theme_classic()
df%>%
ggplot(aes(x = Valores, fill = Distribucion)) +
geom_histogram(alpha = 0.5, position = "identity", bins = 50) +
labs(title = "Comparación de distribuciones Gamma",
x = "Valor",
y = "Frecuencia") +
theme_dark()
df%>%
ggplot(aes(x = Valores, fill = Distribucion)) +
geom_histogram(alpha = 0.5, position = "identity", bins = 50) +
labs(title = "Comparación de distribuciones Gamma",
x = "Valor",
y = "Frecuencia") +
theme_minimal()
df%>%
ggplot(aes(x = Valores, fill = Distribucion)) +
geom_histogram(alpha = 0.5, position = "identity", bins = 50) +
labs(title = "Comparación de distribuciones Gamma",
x = "Valor",
y = "Frecuencia") +
theme_bw()
df%>%
ggplot(aes(x = Valores, fill = Distribucion)) +
geom_histogram(alpha = 0.5, position = "identity", bins = 50) +
labs(title = "Comparación de distribuciones Gamma",
x = "Valor",
y = "Frecuencia") +
theme_replace()
df%>%
ggplot(aes(x = Valores, fill = Distribucion)) +
geom_histogram(alpha = 0.5, position = "identity", bins = 50) +
labs(title = "Comparación de distribuciones Gamma",
x = "Valor",
y = "Frecuencia") +
theme_linedraw()
rm(list = ())
rm(list = ls())
gc
gc()
#----
# Ejercicio 1
library(tidyverse)
# seteo el entorno
getwd()
# seteo el entorno
setwd("~/obser-hub/Clima_II/")
library(tidyverse)
#----
# Ejercicio 1
rendimientos<-read_tsv("./tp5/Rendimientos.tsv")
View(rendimientos)
ggplot(rendimientos,aes(x=rendimientos$Rendimiento,y=rendimientos$Acumulado))+
geom_point()
ggplot(rendimientos,aes(x=rendimientos$Rendimiento,y=rendimientos$Acumulado))+
geom_point()+
xlab(label = "Rendimiento Soja")
ggplot(rendimientos,aes(x=rendimientos$Rendimiento,y=rendimientos$Acumulado))+
geom_point()+
xlab(label = "Rendimiento Soja")+
ylab(label = "PP Acumulada Anual-Venado Tuerto")
ggplot(rendimientos,aes(x=rendimientos$Rendimiento,y=rendimientos$Acumulado))+
geom_point()+
xlab(label = "Rendimiento Soja")+
ylab(label = "PP Acumulada Anual - Venado Tuerto [mm]")
ggplot(rendimientos,aes(y=rendimientos$Rendimiento,x=rendimientos$Acumulado))+
geom_point()+
xlab(label = "Rendimiento Soja")+
ylab(label = "PP Acumulada Anual - Venado Tuerto [mm]")
ggplot(rendimientos,aes(y=rendimientos$Rendimiento,x=rendimientos$Acumulado))+
geom_point()+
ylab(label = "Rendimiento Soja")+
xlab(label = "PP Acumulada Anual - Venado Tuerto [mm]")
ggplot(rendimientos,aes(y=rendimientos$Rendimiento,x=rendimientos$Acumulado))+
geom_point()+
ylab(label = "Rendimiento Soja")+
xlab(label = "PP Acumulada Anual - Venado Tuerto [mm]")+
theme_classic()
ggplot(rendimientos,aes(y=rendimientos$Rendimiento,x=rendimientos$Acumulado))+
geom_point()+
ylab(label = "Rendimiento Soja")+
xlab(label = "PP Acumulada Anual - Venado Tuerto [mm]")+
theme_get()
ggplot(rendimientos,aes(y=rendimientos$Rendimiento,x=rendimientos$Acumulado))+
geom_point()+
ylab(label = "Rendimiento Soja")+
xlab(label = "PP Acumulada Anual - Venado Tuerto [mm]")+
theme_light()
ggplot(rendimientos,aes(y=rendimientos$Rendimiento,x=rendimientos$Acumulado))+
geom_point()+
ylab(label = "Rendimiento Soja")+
xlab(label = "PP Acumulada Anual - Venado Tuerto [mm]")+
theme_bw()
ggplot(rendimientos,aes(y=rendimientos$Rendimiento,x=rendimientos$Acumulado))+
geom_point()#+
ggplot(rendimientos,aes(y=rendimientos$Rendimiento,x=rendimientos$Acumulado))+
geom_point()+
ylab(label = "Rendimiento Soja")+
xlab(label = "PP Acumulada Anual - Venado Tuerto [mm]")+
theme_bw()
?lm()
#b)
modelo<-lm(Rendimiento~Acumulado,data = rendimientos)
View(modelo)
ggplot(rendimientos,aes(y=rendimientos$Rendimiento,x=rendimientos$Acumulado))+
geom_point()+
ylab(label = "Rendimiento Soja")+
xlab(label = "PP Acumulada Anual - Venado Tuerto [mm]")+
geom_abline(intercept = modelo$coefficients[1],slope = modelo$coefficients[2],
col = "blue")
ggplot(rendimientos,aes(y=rendimientos$Rendimiento,x=rendimientos$Acumulado))+
geom_point()+
ylab(label = "Rendimiento Soja")+
xlab(label = "PP Acumulada Anual - Venado Tuerto [mm]")+
geom_abline(intercept = modelo$coefficients[1],slope = modelo$coefficients[2],
col = "blue")+
theme_bw()
ggplot(rendimientos,aes(y=rendimientos$Rendimiento,x=rendimientos$Acumulado,col="Modelo"))+
geom_point()+
ylab(label = "Rendimiento Soja")+
xlab(label = "PP Acumulada Anual - Venado Tuerto [mm]")+
geom_abline(intercept = modelo$coefficients[1],slope = modelo$coefficients[2],
col = "blue")+
theme_bw()
ggplot(rendimientos,aes(y=rendimientos$Rendimiento,x=rendimientos$Acumulado))+
geom_point()+
ylab(label = "Rendimiento Soja")+
xlab(label = "PP Acumulada Anual - Venado Tuerto [mm]")+
geom_abline(intercept = modelo$coefficients[1],slope = modelo$coefficients[2],
color = "Modelo")+
scale_color_manual(name="Referencia",values =c("Modelo"="blue"))+
theme_bw()
ggplot(rendimientos,aes(y=rendimientos$Rendimiento,x=rendimientos$Acumulado))+
geom_point()+
ylab(label = "Rendimiento Soja")+
xlab(label = "PP Acumulada Anual - Venado Tuerto [mm]")+
geom_abline(intercept = modelo$coefficients[1],slope = modelo$coefficients[2],
color = "Modelo")+
scale_color_manual(name="Referencia",values =c("Modelo"="blue"))+
theme_bw()
ggplot(rendimientos,aes(y=rendimientos$Rendimiento,x=rendimientos$Acumulado))+
geom_point()+
ylab(label = "Rendimiento Soja")+
xlab(label = "PP Acumulada Anual - Venado Tuerto [mm]")+
geom_abline(intercept = modelo$coefficients[1],slope = modelo$coefficients[2],
col = "Modelo")+
scale_color_manual(name="Referencia",values =c("Modelo"="blue"))+
theme_bw()
ggplot(rendimientos,aes(y=rendimientos$Rendimiento,x=rendimientos$Acumulado))+
geom_point()+
ylab(label = "Rendimiento Soja")+
xlab(label = "PP Acumulada Anual - Venado Tuerto [mm]")+
geom_abline(aes(intercept = modelo$coefficients[1],slope = modelo$coefficients[2],
col = "Modelo"))+
scale_color_manual(name="Referencia",values=c("Modelo"="blue"))+
theme_bw()
ggplot(rendimientos,aes(y=rendimientos$Rendimiento,x=rendimientos$Acumulado))+
geom_point(color = "Datos")+
ylab(label = "Rendimiento Soja")+
xlab(label = "PP Acumulada Anual - Venado Tuerto [mm]")+
geom_abline(aes(intercept = modelo$coefficients[1],slope = modelo$coefficients[2],
col = "Modelo"))+
scale_color_manual(name="Referencia",values=c("Modelo"="blue","Datos"="black"))+
theme_bw()
ggplot(rendimientos,aes(y=rendimientos$Rendimiento,x=rendimientos$Acumulado))+
geom_point(color = "Datos")+
ylab(label = "Rendimiento Soja")+
xlab(label = "PP Acumulada Anual - Venado Tuerto [mm]")+
geom_abline(aes(intercept = modelo$coefficients[1],slope = modelo$coefficients[2],
col = "Modelo"))+
scale_color_manual(name="Referencia",values=c("Modelo"="blue","Datos"="black"))+
theme_bw()
ggplot(rendimientos,aes(y=rendimientos$Rendimiento,x=rendimientos$Acumulado))+
geom_point()+
ylab(label = "Rendimiento Soja")+
xlab(label = "PP Acumulada Anual - Venado Tuerto [mm]")+
geom_abline(aes(intercept = modelo$coefficients[1],slope = modelo$coefficients[2],
col = "Modelo"))+
scale_color_manual(name="Referencia",values=c("Modelo"="blue"))+
theme_bw()
ggplot(rendimientos,aes(y=rendimientos$Rendimiento,x=rendimientos$Acumulado))+
geom_point(aes(col = "Datos"))+
ylab(label = "Rendimiento Soja")+
xlab(label = "PP Acumulada Anual - Venado Tuerto [mm]")+
geom_abline(aes(intercept = modelo$coefficients[1],slope = modelo$coefficients[2],
col = "Modelo"))+
scale_color_manual(name="Referencia",values=c("Modelo"="blue","Datos"="black"))+
theme_bw()
ggplot(rendimientos,aes(y=rendimientos$Rendimiento,x=rendimientos$Acumulado))+
geom_point(aes(col = "Datos"))+
ylab(label = "Rendimiento Soja")+
xlab(label = "PP Acumulada Anual - Venado Tuerto [mm]")+
geom_abline(aes(intercept = modelo$coefficients[1],slope = modelo$coefficients[2],
col = "Modelo"))+
scale_color_manual(values=c("Modelo"="blue","Datos"="black"))+
theme_bw()
ggplot(rendimientos,aes(y=rendimientos$Rendimiento,x=rendimientos$Acumulado))+
geom_point(aes(col = "Datos"))+
ylab(label = "Rendimiento Soja")+
xlab(label = "PP Acumulada Anual - Venado Tuerto [mm]")+
geom_abline(aes(intercept = modelo$coefficients[1],slope = modelo$coefficients[2],
col = "Modelo"))+
scale_color_manual(name="Referencia",values=c("Modelo"="blue","Datos"="black"))+
theme_bw()
rm(list =ls())
gc()
#----
# Ejercicio 4
caudales<-read_csv("./tp2/df_Caudales.csv")
indices<-read_csv("./tp5/df_indices.csv")
View(indices)
View(caudales)
#----
# Ejercicio 4
caudales<-read_csv("./tp5/df_CaudalesAcumulados.csv")
indices<-read_csv("./tp5/df_indices.csv")
View(caudales)
View(indices)
indices_est<-indices%>%
group_by(Mes)
View(indices_est)
?if
?if()
indices_est<-indices%>%
mutate(Estacion=ifelse(Mes %in% c(12,1,2), "Verano",
ifelse(Mes %in% c(3,4,5),"Otonio",
ifelse(Mes %in% c(6,7,8),"Invierno"),"Primavera")))
indices_est<-indices%>%
mutate(Estacion=ifelse(Mes %in% c(12,1,2), "Verano",
ifelse(Mes %in% 3:5,"Otonio",
ifelse(Mes %in% 6:8,"Invierno"),"Primavera")))
indices_est<-indices%>%
mutate(Estacion=ifelse(Mes %in% c(12,1,2), "Verano",
ifelse(Mes %in% 3:5,"Otonio",
ifelse(Mes %in% 6:8,"Invierno","Primavera"))))
indices_est<-indices%>%
mutate(Estacion=ifelse(Mes %in% c(12,1,2), "Verano",
ifelse(Mes %in% 3:5,"Otonio",
ifelse(Mes %in% 6:8,"Invierno","Primavera"))))
View(indices_est)
indices_est<-indices%>%
mutate(Estacion=ifelse(Mes %in% c(12,1,2), "Verano",
ifelse(Mes %in% 3:5,"Otonio",
ifelse(Mes %in% 6:8,"Invierno","Primavera"))))%>%
select(-Mes)%>%
pivot_longer(cols = -Anio,
values_to = "Valor",
names_to = "Indices")
indices_est<-indices%>%
mutate(Estacion=ifelse(Mes %in% c(12,1,2), "Verano",
ifelse(Mes %in% 3:5,"Otonio",
ifelse(Mes %in% 6:8,"Invierno","Primavera"))))%>%
select(-Mes)%>%
pivot_longer(cols = c(-Anio,-Estacion),
values_to = "Valor",
names_to = "Indices"
indices%>%
mutate(Estacion=ifelse(Mes %in% c(12,1,2), "Verano",
ifelse(Mes %in% 3:5,"Otonio",
ifelse(Mes %in% 6:8,"Invierno","Primavera"))))%>%
select(-Mes)%>%
pivot_longer(cols = c(-Anio,-Estacion),
values_to = "Valor",
names_to = "Indices")
View(indices)
indices<-read_csv("./tp5/df_indices.csv")
indices%>%
mutate(Estacion=ifelse(Mes %in% c(12,1,2), "Verano",
ifelse(Mes %in% 3:5,"Otonio",
ifelse(Mes %in% 6:8,"Invierno","Primavera"))))%>%
select(-Mes)%>%
pivot_longer(cols = c(-Anio,-Estacion),
values_to = "Valor",
names_to = "Indices")
indices_est<-indices%>%
mutate(Estacion=ifelse(Mes %in% c(12,1,2), "Verano",
ifelse(Mes %in% 3:5,"Otonio",
ifelse(Mes %in% 6:8,"Invierno","Primavera"))),
Anio_aux=ifelse(Mes==12,Anio+1,Anio))%>%
select(-Mes)%>%
pivot_longer(cols = c(-Anio,-Estacion),
values_to = "Valor",
names_to = "Indices")%>%
group_by(Anio_aux,Estacion,Indices)%>%
summarise(Promedio=mean(Valor))
indices<-read_csv("./tp5/df_indices.csv")
indices_est<-indices%>%
mutate(Estacion=ifelse(Mes %in% c(12,1,2), "Verano",
ifelse(Mes %in% 3:5,"Otonio",
ifelse(Mes %in% 6:8,"Invierno","Primavera"))),
Anio_aux=ifelse(Mes==12,Anio+1,Anio))%>%
select(-Mes)%>%
pivot_longer(cols = c(-Anio,-Estacion),
values_to = "Valor",
names_to = "Indices")%>%
group_by(Anio_aux,Estacion,Indices)%>%
summarise(Promedio=mean(Valor))
ndices_est<-indices%>%
mutate(Estacion=ifelse(Mes %in% c(12,1,2), "Verano",
ifelse(Mes %in% 3:5,"Otonio",
ifelse(Mes %in% 6:8,"Invierno","Primavera"))),
Anio_aux=ifelse(Mes==12,Anio+1,Anio))
indices_est<-indices%>%
mutate(Estacion=ifelse(Mes %in% c(12,1,2), "Verano",
ifelse(Mes %in% 3:5,"Otonio",
ifelse(Mes %in% 6:8,"Invierno","Primavera"))),
Anio_aux=ifelse(Mes==12,Anio+1,Anio))%>%
select(-Mes)%>%
pivot_longer(cols = c(-Anio_aux,-Estacion),
values_to = "Valor",
names_to = "Indices")%>%
group_by(Anio_aux,Estacion,Indices)%>%
summarise(Promedio=mean(Valor))
#b)
andacollo<-caudales%>%
filter(Estacion=="Andacollo",Fase=="Fase_Max",Anio<2010)%>%
pull(Acumulado)
#----
# Ejercicio 4
caudales<-read_csv("./tp5/df_CaudalesAcumulados.csv")
#b)
andacollo<-caudales%>%
filter(Estacion=="Andacollo",Fase=="Fase_max",Anio<2010)%>%
pull(Acumulado)
correlaciones<-data.frame()
correlaciones<-tibbe()
correlaciones<-tibble()
?rep()
#a)
indices_est<-indices%>%
mutate(Estacion=ifelse(Mes %in% c(12,1,2), "Verano",
ifelse(Mes %in% 3:5,"Otonio",
ifelse(Mes %in% 6:8,"Invierno","Primavera"))),
Anio_aux=ifelse(Mes==12,Anio+1,Anio))%>% #(*)
select(-Mes,-Anio)%>%
pivot_longer(cols = c(-Anio_aux,-Estacion),
values_to = "Valor",
names_to = "Indices")%>%
group_by(Anio_aux,Estacion,Indices)%>%
summarise(Promedio=mean(Valor))
correlaciones<-tibble(Indice=rep(c("iod","nino12","nino34","nino4","sam","tna","tsa"),times=3),
Estacion=rep(c("Otonio","Invierno","Primavera"),each=7),
Correlacion=NA,
Significancia=NA)
View(correlaciones)
for(i in c("iod","nino12","nino34","nino4","sam","tna","tsa")){
for(j in c("Otonio","Invierno","Primavera")){
fila<-which(correlaciones$Indice==i & correlaciones$Estacion==j)
correlaciones$Correlacion[fila]<-cor(andacollo,indices_est%>%filter(Indices==i,Estacion==j)%>%
pull(Prom))
}
for(i in c("iod","nino12","nino34","nino4","sam","tna","tsa")){
for(j in c("Otonio","Invierno","Primavera")){
fila<-which(correlaciones$Indice==i & correlaciones$Estacion==j)
correlaciones$Correlacion[fila]<-cor(andacollo,indices_est%>%filter(Indices==i,Estacion==j)%>%
pull(Promedio))
}
indices_est%>%filter(Indices==i,Estacion==j)%>%
pull(Promedio))
#----
# Ejercicio 4
caudales<-read_csv("./tp5/df_CaudalesAcumulados.csv")
indices<-read_csv("./tp5/df_indices.csv")
#a)
indices_est<-indices%>%
mutate(Estacion=ifelse(Mes %in% c(12,1,2), "Verano",
ifelse(Mes %in% 3:5,"Otonio",
ifelse(Mes %in% 6:8,"Invierno","Primavera"))),
Anio_aux=ifelse(Mes==12,Anio+1,Anio))%>% #(*)
select(-Mes,-Anio)%>%
pivot_longer(cols = c(-Anio_aux,-Estacion),
values_to = "Valor",
names_to = "Indices")%>%
group_by(Anio_aux,Estacion,Indices)%>%
summarise(Promedio=mean(Valor))
for(i in c("iod","nino12","nino34","nino4","sam","tna","tsa")){
for(j in c("Otonio","Invierno","Primavera")){
fila<-which(correlaciones$Indice==i & correlaciones$Estacion==j)
correlaciones$Correlacion[fila]<-cor(andacollo,indices_est%>%filter(Indices==i,Estacion==j)%>%
pull(Promedio))
}
#a)
indices_est<-indices%>%
mutate(Estacion=ifelse(Mes %in% c(12,1,2), "Verano",
ifelse(Mes %in% 3:5,"Otonio",
ifelse(Mes %in% 6:8,"Invierno","Primavera"))),
Anio_aux=ifelse(Mes==12,Anio+1,Anio))%>% #(*)
select(-Mes,-Anio)%>%
pivot_longer(cols = c(-Anio_aux,-Estacion),
values_to = "Valor",
names_to = "Indices")%>%
group_by(Anio_aux,Estacion,Indices)%>%
summarise(Promedio=mean(Valor))%>%
filter(Anio<2010)
#a)
indices_est<-indices%>%
mutate(Estacion=ifelse(Mes %in% c(12,1,2), "Verano",
ifelse(Mes %in% 3:5,"Otonio",
ifelse(Mes %in% 6:8,"Invierno","Primavera"))),
Anio_aux=ifelse(Mes==12,Anio+1,Anio))%>% #(*)
select(-Mes,-Anio)%>%
pivot_longer(cols = c(-Anio_aux,-Estacion),
values_to = "Valor",
names_to = "Indices")%>%
group_by(Anio_aux,Estacion,Indices)%>%
summarise(Promedio=mean(Valor))%>%
filter(Anio_aux<2010)
for(i in c("iod","nino12","nino34","nino4","sam","tna","tsa")){
for(j in c("Otonio","Invierno","Primavera")){
fila<-which(correlaciones$Indice==i & correlaciones$Estacion==j)
correlaciones$Correlacion[fila]<-cor(andacollo,indices_est%>%filter(Indices==i,Estacion==j)%>%
pull(Promedio))
}
?cor.test
cor.test(andacollo,indices_est%>%filter(Indices==i,Estacion==j)%>%
pull(Promedio))
cor.test(andacollo,indices_est%>%filter(Indices==i,Estacion==j)%>%
pull(Promedio))$p.value<0.05
}
cor.test(andacollo,indices_est%>%filter(Indices==i,Estacion==j)%>%
pull(Promedio))$p.value<0.05
for(i in c("iod","nino12","nino34","nino4","sam","tna","tsa")){
for(j in c("Otonio","Invierno","Primavera")){
fila<-which(correlaciones$Indice==i & correlaciones$Estacion==j)
correlaciones$Correlacion[fila]<-cor(andacollo,indices_est%>%filter(Indices==i,Estacion==j)%>%
pull(Promedio))
correlaciones$Significancia[fila]<-cor.test(andacollo,indices_est%>%filter(Indices==i,Estacion==j)%>%
pull(Promedio))$p.value<0.05
}
